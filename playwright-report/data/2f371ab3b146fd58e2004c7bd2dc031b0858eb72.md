# Test info

- Name: Full Flow: Classroom registration and search (auth skipped) >> Register classroom and search as authenticated user
- Location: /Users/akipinnote/Downloads/2025-05-25Lovable/rhythm-find-harmony/tests/e2e/fullFlow.spec.ts:24:3

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toHaveURL(expected)

Locator: locator(':root')
Expected string: "http://localhost:3000/dashboard"
Received string: "http://localhost:3000/classroom/register"
Call log:
  - expect.toHaveURL with timeout 5000ms
  - waiting for locator(':root')
    9 × locator resolved to <html lang="en">…</html>
      - unexpected value "http://localhost:3000/classroom/register"

    at /Users/akipinnote/Downloads/2025-05-25Lovable/rhythm-find-harmony/tests/e2e/fullFlow.spec.ts:48:24
```

# Page snapshot

```yaml
- region "Notifications (F8)":
  - list:
    - status:
      - text: エラー 下書き保存に失敗しました。もう一度お試しください。
      - button:
        - img
- banner:
  - link "Piano Search":
    - /url: /
  - navigation:
    - link "教室を探す":
      - /url: /search
    - link "About":
      - /url: /about
    - link "お問い合わせ":
      - /url: /contact
  - link "ログイン":
    - /url: /auth
  - link "教室を掲載する":
    - /url: /classroom/register
- main:
  - navigation "パンくずリスト":
    - list:
      - listitem:
        - img
        - link "ホーム":
          - /url: /
      - listitem:
        - img
        - text: 教室登録
  - heading "教室情報登録" [level=1]
  - paragraph: あなたの教室情報を登録して、生徒さんとの出会いを広げましょう。登録後、月額500円のお支払いで情報が公開されます。
  - heading "基本情報" [level=3]:
    - img
    - text: 基本情報
  - paragraph: 教室の基本的な情報を入力してください
  - text: 教室名 *
  - textbox "教室名 *": テスト教室A
  - text: 教室の説明 *
  - textbox "教室の説明 *": これはテスト教室の説明文です。十分な長さがあります。
  - text: 写真アップロード
  - img
  - paragraph: クリックまたはドラッグで画像をアップロード
  - paragraph: PNG, JPG (最大5MB)
  - heading "所在地" [level=3]:
    - img
    - text: 所在地
  - paragraph: 教室の住所情報を入力してください
  - text: 都道府県 *
  - combobox "都道府県 *":
    - option "選択してください"
    - option "北海道"
    - option "青森県"
    - option "岩手県"
    - option "宮城県"
    - option "秋田県"
    - option "山形県"
    - option "福島県"
    - option "茨城県"
    - option "栃木県"
    - option "群馬県"
    - option "埼玉県"
    - option "千葉県"
    - option "東京都" [selected]
    - option "神奈川県"
    - option "新潟県"
    - option "富山県"
    - option "石川県"
    - option "福井県"
    - option "山梨県"
    - option "長野県"
    - option "岐阜県"
    - option "静岡県"
    - option "愛知県"
    - option "三重県"
    - option "滋賀県"
    - option "京都府"
    - option "大阪府"
    - option "兵庫県"
    - option "奈良県"
    - option "和歌山県"
    - option "鳥取県"
    - option "島根県"
    - option "岡山県"
    - option "広島県"
    - option "山口県"
    - option "徳島県"
    - option "香川県"
    - option "愛媛県"
    - option "高知県"
    - option "福岡県"
    - option "佐賀県"
    - option "長崎県"
    - option "熊本県"
    - option "大分県"
    - option "宮崎県"
    - option "鹿児島県"
    - option "沖縄県"
  - text: 市区町村 *
  - textbox "市区町村 *": 渋谷区
  - text: 番地・建物名 *
  - textbox "番地・建物名 *": 1-2-3
  - heading "連絡先" [level=3]:
    - img
    - text: 連絡先
  - paragraph: 生徒さんが連絡できる方法を入力してください
  - text: 電話番号
  - textbox "電話番号": 03-1234-5678
  - paragraph: 公開したくない場合は空欄でも構いません
  - text: メールアドレス *
  - textbox "メールアドレス *": info-teach@example.com
  - text: ウェブサイト
  - textbox "ウェブサイト": https://example.com
  - heading "レッスン情報" [level=3]:
    - img
    - text: レッスン情報
  - paragraph: レッスンの詳細を入力してください
  - text: レッスンの種類 *
  - checkbox "ピアノ" [checked]:
    - img
  - text: ピアノ
  - checkbox "リトミック"
  - text: リトミック
  - checkbox "ソルフェージュ"
  - text: ソルフェージュ
  - checkbox "アンサンブル"
  - text: アンサンブル
  - checkbox "作曲"
  - text: 作曲 対象年齢 *
  - checkbox "幼児（0-6歳）" [checked]:
    - img
  - text: 幼児（0-6歳）
  - checkbox "小学生"
  - text: 小学生
  - checkbox "中学生"
  - text: 中学生
  - checkbox "高校生"
  - text: 高校生
  - checkbox "大人"
  - text: 大人
  - checkbox "シニア"
  - text: シニア レッスン可能曜日 *
  - checkbox "月曜日" [checked]:
    - img
  - text: 月曜日
  - checkbox "火曜日"
  - text: 火曜日
  - checkbox "水曜日"
  - text: 水曜日
  - checkbox "木曜日"
  - text: 木曜日
  - checkbox "金曜日"
  - text: 金曜日
  - checkbox "土曜日"
  - text: 土曜日
  - checkbox "日曜日"
  - text: 日曜日 レッスン時間帯
  - textbox "レッスン時間帯": 平日10:00-18:00
  - text: 料金目安 *
  - textbox "料金目安 *": 月謝8000円〜12000円、入会金5000円
  - heading "追加情報" [level=3]:
    - img
    - text: 追加情報
  - paragraph: その他のPR情報を入力してください
  - text: 講師紹介
  - textbox "講師紹介"
  - text: PRポイント
  - textbox "PRポイント"
  - button "下書きとして保存"
  - paragraph: 💡 無料で下書き保存できます。公開は管理画面から月額500円でスタート！
  - paragraph: 保存後はいつでも編集・修正が可能です
  - link "管理画面へ戻る":
    - /url: /dashboard
- contentinfo:
  - paragraph: © 2025 Piano Search. All rights reserved.
  - link "About":
    - /url: /about
  - link "利用規約":
    - /url: /terms
  - link "プライバシーポリシー":
    - /url: /privacy
  - link "お問い合わせ":
    - /url: /contact
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 |
   3 | test.describe('Full Flow: Classroom registration and search (auth skipped)', () => {
   4 |   let consoleMessages: string[] = [];
   5 |
   6 |   test.beforeEach(async ({ page }) => {
   7 |     // 認証をスキップ: E2EフラグとSupabaseセッションをlocalStorageにセット
   8 |     await page.addInitScript(() => {
   9 |       localStorage.setItem('e2eAuth', '1');
  10 |       localStorage.setItem('supabase.auth.token', JSON.stringify({
  11 |         access_token: 'token',
  12 |         refresh_token: 'token',
  13 |         provider_token: null,
  14 |         token_type: 'bearer',
  15 |         expires_in: 3600,
  16 |         expires_at: Math.floor(Date.now() / 1000) + 3600,
  17 |         user: { id: 'user-id', email: 'teacher@example.com' }
  18 |       }));
  19 |     });
  20 |     consoleMessages = [];
  21 |     page.on('console', msg => consoleMessages.push(`${msg.type()}: ${msg.text()}`));
  22 |   });
  23 |
  24 |   test('Register classroom and search as authenticated user', async ({ page }) => {
  25 |     // 認証済み状態でダッシュボードにアクセス
  26 |     await page.goto('/dashboard');
  27 |     await expect(page).toHaveURL('/dashboard');
  28 |
  29 |     // 教室登録ページにアクセス
  30 |     await page.goto('/classroom/register');
  31 |     // フォームが表示されるまで待機
  32 |     await page.waitForSelector('input[placeholder="例：〇〇ピアノ教室"]', { timeout: 10000 });
  33 |     await page.fill('input[placeholder="例：〇〇ピアノ教室"]', 'テスト教室A');
  34 |     await page.fill('textarea[placeholder*="教室の特徴や雰囲気"]', 'これはテスト教室の説明文です。十分な長さがあります。');
  35 |     await page.selectOption('select', '東京都');
  36 |     await page.fill('input[placeholder="例：渋谷区"]', '渋谷区');
  37 |     await page.fill('input[placeholder="例：1-2-3 〇〇ビル2F"]', '1-2-3');
  38 |     await page.fill('input[placeholder="例：03-1234-5678"]', '03-1234-5678');
  39 |     await page.fill('input[placeholder="例：info@example.com"]', 'info-teach@example.com');
  40 |     await page.fill('input[placeholder="例：https://www.example.com"]', 'https://example.com');
  41 |     await page.click('label:has-text("ピアノ")');
  42 |     await page.click('label:has-text("幼児（0-6歳）")');
  43 |     await page.click('label:has-text("月曜日")');
  44 |     await page.fill('input[placeholder="例：平日10:00-18:00、土日10:00-15:00"]', '平日10:00-18:00');
  45 |     await page.fill('input[placeholder="例：月謝8,000円〜12,000円、入会金5,000円"]', '月謝8000円〜12000円、入会金5000円');
  46 |     // フォーム送信で下書き保存
  47 |     await page.click('form >> button[type="submit"]');
> 48 |     await expect(page).toHaveURL('/dashboard');
     |                        ^ Error: Timed out 5000ms waiting for expect(locator).toHaveURL(expected)
  49 |
  50 |     // 検索画面で教室を検索
  51 |     await page.goto('/search');
  52 |     await page.fill('input[placeholder="教室名、エリア、特徴などで検索"]', 'テスト教室A');
  53 |     await page.click('button:has-text("検索")');
  54 |     await expect(page.locator('text=テスト教室A')).toBeVisible();
  55 |
  56 |     // Assert no console errors
  57 |     const errors = consoleMessages.filter(msg => msg.startsWith('error') || msg.includes('Failed'));
  58 |     expect(errors).toEqual([]);
  59 |   });
  60 | }); 
```